{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nconst _c0 = [\"video\"];\nfunction ParticipantComponent__svg_svg_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"svg\", 5)(1, \"style\");\n    i0.ɵɵtext(2, \"svg{fill:#ffffff}\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"path\", 6);\n    i0.ɵɵelementEnd();\n  }\n}\nexport class ParticipantComponent {\n  constructor() {\n    this.isMicroActive = false;\n  }\n  handleMediaInput(data) {\n    const canvasContext = this.videoEl.nativeElement.getContext('2d');\n    const blob = new Blob([data], {\n      type: 'image/png'\n    });\n    const blobUrl = URL.createObjectURL(blob);\n    const imageElement = new Image();\n    // Set the source of the Image element to the Blob URL\n    imageElement.src = blobUrl;\n    // Wait for the image to load\n    imageElement.onload = function () {\n      // Draw the image onto the canvas\n      canvasContext.drawImage(imageElement, 0, 0, canvasElement.width, canvasElement.height);\n      // Optionally, free up resources by revoking the Blob URL\n      URL.revokeObjectURL(blobUrl);\n    };\n    this.videoEl.nativeElement.src = blobUrl;\n  }\n  static #_ = this.ɵfac = function ParticipantComponent_Factory(t) {\n    return new (t || ParticipantComponent)();\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ParticipantComponent,\n    selectors: [[\"app-participant\"]],\n    viewQuery: function ParticipantComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.videoEl = _t.first);\n      }\n    },\n    inputs: {\n      participant: \"participant\"\n    },\n    decls: 7,\n    vars: 2,\n    consts: [[1, \"video-container\"], [\"video\", \"\"], [1, \"micro-icon\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"height\", \"1em\", \"viewBox\", \"0 0 640 512\", 4, \"ngIf\"], [1, \"participant-name\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"height\", \"1em\", \"viewBox\", \"0 0 640 512\"], [\"d\", \"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L472.1 344.7c15.2-26 23.9-56.3 23.9-88.7V216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 21.2-5.1 41.1-14.2 58.7L416 300.8V96c0-53-43-96-96-96s-96 43-96 96v54.3L38.8 5.1zM344 430.4c20.4-2.8 39.7-9.1 57.3-18.2l-43.1-33.9C346.1 382 333.3 384 320 384c-70.7 0-128-57.3-128-128v-8.7L144.7 210c-.5 1.9-.7 3.9-.7 6v40c0 89.1 66.2 162.7 152 174.4V464H248c-13.3 0-24 10.7-24 24s10.7 24 24 24h72 72c13.3 0 24-10.7 24-24s-10.7-24-24-24H344V430.4z\"]],\n    template: function ParticipantComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"canvas\", null, 1);\n        i0.ɵɵelementStart(3, \"div\", 2);\n        i0.ɵɵtemplate(4, ParticipantComponent__svg_svg_4_Template, 4, 0, \"svg\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"span\", 4);\n        i0.ɵɵtext(6);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isMicroActive);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.participant.name);\n      }\n    },\n    dependencies: [i1.NgIf],\n    styles: [\".video-container[_ngcontent-%COMP%] {\\n  position: relative;\\n  display: flex;\\n  height: 100%;\\n  justify-content: center;\\n}\\n.video-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%] {\\n  position: absolute;\\n  width: 100%;\\n  height: 100%;\\n  object-fit: cover;\\n  z-index: 5;\\n}\\n.video-container[_ngcontent-%COMP%]   .micro-icon[_ngcontent-%COMP%] {\\n  position: absolute;\\n  right: 15px;\\n  top: 15px;\\n  font-size: 1.5em;\\n  z-index: 10;\\n}\\n.video-container[_ngcontent-%COMP%]   .participant-name[_ngcontent-%COMP%] {\\n  align-self: center;\\n  font-size: 130%;\\n  color: #fff;\\n  font-weight: 600;\\n  text-shadow: 1px 1px 5px #000;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFydGljaXBhbnQvcGFydGljaXBhbnQuY29tcG9uZW50LnNjc3MiLCJ3ZWJwYWNrOi8vLi8uLi8uLi8uLi8lRDAlOUIlRDAlQjAlRDAlQjElRDAlQkElRDAlQjgvVmlkZW9DaGF0L2NsaWVudC9zcmMvYXBwL3BhcnRpY2lwYW50L3BhcnRpY2lwYW50LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksa0JBQUE7RUFDQSxhQUFBO0VBQ0EsWUFBQTtFQUNBLHVCQUFBO0FDQ0o7QURDSTtFQUNJLGtCQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSxpQkFBQTtFQUNBLFVBQUE7QUNDUjtBREVJO0VBQ0ksa0JBQUE7RUFDQSxXQUFBO0VBQ0EsU0FBQTtFQUNBLGdCQUFBO0VBQ0EsV0FBQTtBQ0FSO0FER0k7RUFDSSxrQkFBQTtFQUNBLGVBQUE7RUFDQSxXQUFBO0VBQ0EsZ0JBQUE7RUFDQSw2QkFBQTtBQ0RSIiwic291cmNlc0NvbnRlbnQiOlsiLnZpZGVvLWNvbnRhaW5lciB7XHJcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcblxyXG4gICAgY2FudmFzIHtcclxuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgICAgIG9iamVjdC1maXQ6IGNvdmVyO1xyXG4gICAgICAgIHotaW5kZXg6IDU7XHJcbiAgICB9XHJcblxyXG4gICAgLm1pY3JvLWljb24ge1xyXG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICByaWdodDogMTVweDtcclxuICAgICAgICB0b3A6IDE1cHg7XHJcbiAgICAgICAgZm9udC1zaXplOiAxLjVlbTtcclxuICAgICAgICB6LWluZGV4OiAxMDtcclxuICAgIH1cclxuXHJcbiAgICAucGFydGljaXBhbnQtbmFtZSB7XHJcbiAgICAgICAgYWxpZ24tc2VsZjogY2VudGVyO1xyXG4gICAgICAgIGZvbnQtc2l6ZTogMTMwJTtcclxuICAgICAgICBjb2xvcjogI2ZmZjtcclxuICAgICAgICBmb250LXdlaWdodDogNjAwO1xyXG4gICAgICAgIHRleHQtc2hhZG93OiAxcHggMXB4IDVweCAjMDAwO1xyXG4gICAgfVxyXG59IiwiLnZpZGVvLWNvbnRhaW5lciB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgZGlzcGxheTogZmxleDtcbiAgaGVpZ2h0OiAxMDAlO1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbn1cbi52aWRlby1jb250YWluZXIgY2FudmFzIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xuICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgei1pbmRleDogNTtcbn1cbi52aWRlby1jb250YWluZXIgLm1pY3JvLWljb24ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHJpZ2h0OiAxNXB4O1xuICB0b3A6IDE1cHg7XG4gIGZvbnQtc2l6ZTogMS41ZW07XG4gIHotaW5kZXg6IDEwO1xufVxuLnZpZGVvLWNvbnRhaW5lciAucGFydGljaXBhbnQtbmFtZSB7XG4gIGFsaWduLXNlbGY6IGNlbnRlcjtcbiAgZm9udC1zaXplOiAxMzAlO1xuICBjb2xvcjogI2ZmZjtcbiAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgdGV4dC1zaGFkb3c6IDFweCAxcHggNXB4ICMwMDA7XG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":";;;;;IAIQA,mBAAkG;IAAlGA,8BAAkG;IAAOA,iCAAiB;IAAAA,iBAAQ;IAAAA,0BAAuiB;IAAAA,iBAAM;;;ACKvrB,OAAM,MAAOC,oBAAoB;EALjCC;IASS,kBAAa,GAAG,KAAK;;EAErBC,gBAAgB,CAACC,IAAgB;IACtC,MAAMC,aAAa,GAAG,IAAI,CAACC,OAAO,CAACC,aAAa,CAACC,UAAU,CAAC,IAAI,CAAC;IACjE,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACN,IAAI,CAAC,EAAE;MAAEO,IAAI,EAAE;IAAW,CAAE,CAAC;IACpD,MAAMC,OAAO,GAAGC,GAAG,CAACC,eAAe,CAACL,IAAI,CAAC;IACzC,MAAMM,YAAY,GAAG,IAAIC,KAAK,EAAE;IAEhC;IACAD,YAAY,CAACE,GAAG,GAAGL,OAAO;IAE1B;IACAG,YAAY,CAACG,MAAM,GAAG;MAClB;MACAb,aAAa,CAACc,SAAS,CAACJ,YAAY,EAAE,CAAC,EAAE,CAAC,EAAEK,aAAa,CAACC,KAAK,EAAED,aAAa,CAACE,MAAM,CAAC;MAEtF;MACAT,GAAG,CAACU,eAAe,CAACX,OAAO,CAAC;IAChC,CAAC;IACD,IAAI,CAACN,OAAO,CAACC,aAAa,CAACU,GAAG,GAAGL,OAAO;EAC1C;EAAC;qBAxBUX,oBAAoB;EAAA;EAAA;UAApBA,oBAAoB;IAAAuB;IAAAC;MAAA;;;;;;;;;;;;;;;;QDTjCzB,8BAA6B;QAEzBA,kCAAwB;QACxBA,8BAAwB;QACpBA,0EAA+qB;QACnrBA,iBAAM;QACNA,+BAA+B;QAAAA,YAAoB;QAAAA,iBAAO;;;QAFhDA,eAAoB;QAApBA,yCAAoB;QAECA,eAAoB;QAApBA,0CAAoB","names":["i0","ParticipantComponent","constructor","handleMediaInput","data","canvasContext","videoEl","nativeElement","getContext","blob","Blob","type","blobUrl","URL","createObjectURL","imageElement","Image","src","onload","drawImage","canvasElement","width","height","revokeObjectURL","selectors","viewQuery"],"sourceRoot":"","sources":["D:\\Лабки\\VideoChat\\client\\src\\app\\participant\\participant.component.html","D:\\Лабки\\VideoChat\\client\\src\\app\\participant\\participant.component.ts"],"sourcesContent":["<div class=\"video-container\">\n    <!-- <video autoplay=\"true\" #video></video> -->\n    <canvas #video></canvas>\n    <div class=\"micro-icon\">\n        <svg *ngIf=\"!isMicroActive\" xmlns=\"http://www.w3.org/2000/svg\" height=\"1em\" viewBox=\"0 0 640 512\"><style>svg{fill:#ffffff}</style><path d=\"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L472.1 344.7c15.2-26 23.9-56.3 23.9-88.7V216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 21.2-5.1 41.1-14.2 58.7L416 300.8V96c0-53-43-96-96-96s-96 43-96 96v54.3L38.8 5.1zM344 430.4c20.4-2.8 39.7-9.1 57.3-18.2l-43.1-33.9C346.1 382 333.3 384 320 384c-70.7 0-128-57.3-128-128v-8.7L144.7 210c-.5 1.9-.7 3.9-.7 6v40c0 89.1 66.2 162.7 152 174.4V464H248c-13.3 0-24 10.7-24 24s10.7 24 24 24h72 72c13.3 0 24-10.7 24-24s-10.7-24-24-24H344V430.4z\"/></svg>\n    </div>\n    <span class=\"participant-name\">{{participant.name}}</span>\n</div>\n","import { Component, ElementRef, Input, ViewChild, OnChanges } from '@angular/core';\nimport { Participant } from 'src/model/participant';\nimport { MediaService } from 'src/service/media.service';\n\n@Component({\n  selector: 'app-participant',\n  templateUrl: './participant.component.html',\n  styleUrls: ['./participant.component.scss']\n})\nexport class ParticipantComponent {\n  @ViewChild(\"video\") public videoEl! : ElementRef;\n  @Input() public participant!: Participant;\n\n  public isMicroActive = false;\n\n  public handleMediaInput(data: Uint8Array) {\n    const canvasContext = this.videoEl.nativeElement.getContext('2d');\n    const blob = new Blob([data], { type: 'image/png' });\n    const blobUrl = URL.createObjectURL(blob);\n    const imageElement = new Image();\n\n    // Set the source of the Image element to the Blob URL\n    imageElement.src = blobUrl;\n\n    // Wait for the image to load\n    imageElement.onload = function() {\n        // Draw the image onto the canvas\n        canvasContext.drawImage(imageElement, 0, 0, canvasElement.width, canvasElement.height);\n\n        // Optionally, free up resources by revoking the Blob URL\n        URL.revokeObjectURL(blobUrl);\n    };\n    this.videoEl.nativeElement.src = blobUrl;\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}